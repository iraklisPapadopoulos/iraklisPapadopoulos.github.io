<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Network Analysis in R | Iraklis Papadopoulos</title> <meta name="author" content="Iraklis Papadopoulos"> <meta name="description" content="Main principles and R code to perform network analysis in R."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/favicon.png?df97677b22c62578555e686f9796e961"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://iraklispapadopoulos.github.io/blog/2024/network/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Iraklis </span>Papadopoulos</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/Presentations/">Presentations</a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/projects/">projects</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Network Analysis in R</h1> <p class="post-meta">January 25, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/network"> <i class="fa-solid fa-hashtag fa-sm"></i> network</a>     ·   <a href="/blog/category/visualization"> <i class="fa-solid fa-tag fa-sm"></i> visualization</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="introduction-to-network-analysis">Introduction to Network Analysis</h1> <p>Network analysis is a powerful tool used to study complex systems composed of interconnected elements, such as social networks, biological systems, or infrastructure networks. It allows researchers to understand the structure and dynamics of relationships between individual components within a system.</p> <h2 id="what-is-network-analysis">What is Network Analysis?</h2> <p>Network analysis involves representing a system as a network, which consists of nodes (representing entities) and edges (representing relationships or interactions between entities). By studying the patterns of connections and interactions within the network, researchers can gain insights into the underlying structure and behavior of the system.</p> <h2 id="visualization">Visualization</h2> <p>Visualization is crucial for understanding and interpreting network data. Network analysis often involves creating visual representations of the network using graphical techniques. These visualizations can range from simple node-and-edge diagrams to more complex layouts that highlight various properties of the network, such as node centrality or community structure.</p> <h2 id="testing-accuracy">Testing Accuracy</h2> <p>Assessing the accuracy of a network model involves comparing it to empirical data or evaluating its predictive performance. This can be done using statistical techniques such as goodness-of-fit tests, cross-validation, or comparing model predictions to observed outcomes.</p> <h2 id="centrality">Centrality</h2> <p>Centrality measures quantify the importance or influence of nodes within a network. Nodes with high centrality are often considered to be more central or influential within the network. Common centrality measures include degree centrality (number of connections), betweenness centrality (importance of a node in connecting other nodes), and closeness centrality (average distance to all other nodes).</p> <h2 id="comparing-networks">Comparing Networks</h2> <p>Comparing networks involves assessing similarities or differences between two or more networks. This can be done by comparing their topological properties, such as degree distributions, average path lengths, or clustering coefficients. Additionally, specialized techniques exist for comparing networks with different node sets or edge weights.</p> <h1 id="r-packages-for-network-analysis">R Packages for Network Analysis</h1> <p>The <code class="language-plaintext highlighter-rouge">qgraph</code> and <code class="language-plaintext highlighter-rouge">netboot</code> packages in R provide tools for visualizing and analyzing networks.</p> <ul> <li> <code class="language-plaintext highlighter-rouge">qgraph</code>: Particularly useful for creating high-quality network visualizations.</li> <li> <code class="language-plaintext highlighter-rouge">netboot</code>: Offers methods for bootstrapping network models to test their stability and accuracy.</li> </ul> <p>By leveraging these packages, researchers can gain valuable insights into the structure and dynamics of complex systems through network analysis in R.</p> <h1 id="an-example">An Example</h1> <p>In this example, we’ll perform network analysis on a dataset of Covid-19 infection symptoms using R. We’ll visualize the correlation network, test the significance of correlations, and estimate the network structure.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load required libraries</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">corrplot</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">corpcor</span><span class="p">)</span><span class="w">  </span><span class="c1"># for partial correlation</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">qgraph</span><span class="p">)</span><span class="w"> </span><span class="c1"># for visualization</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">bootnet</span><span class="p">)</span><span class="w"> </span><span class="c1"># to estimate stability</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span><span class="w">  </span><span class="c1">#to use grid.arrange</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">QuantPsyc</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h2 id="the-data-preparation">The data preparation</h2> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Define COVID-19 symptoms</span><span class="w">
</span><span class="n">symptoms</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Fever"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Cough"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Shortness of breath"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Fatigue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Muscle or body aches"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"Headache"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Sore throat"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Loss of taste or smell"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Congestion or runny nose"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"Nausea or vomiting"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Generate random data for correlation between symptoms</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">num_symptoms</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">symptoms</span><span class="p">)</span><span class="w">

</span></code></pre></div></div> <h2 id="estimating-and-visualizing-network-structure">Estimating and Visualizing Network Structure</h2> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">correlation_matrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">num_symptoms</span><span class="o">^</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.5</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_symptoms</span><span class="p">)</span><span class="w">

</span><span class="c1"># Set diagonal to 1</span><span class="w">
</span><span class="n">diag</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="c1"># Estimate the network structure</span><span class="w">
</span><span class="n">network</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">estimateNetwork</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"pcor"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plot the estimated network</span><span class="w">
</span><span class="c1">#png("network.png",units="cm", width=12, height=12,res=500)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">symptoms</span><span class="p">)</span><span class="w">
</span><span class="c1">#dev.off()</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/network/network-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/network/network-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/network/network-1400.webp"></source> <img src="/assets/img/posts/network/network.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="caption"> Network structure between Covid-19 symptoms. </div> <h2 id="centrality-and-accuracy">Centrality and Accuracy</h2> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#png("centrality.png",units="cm", width=12, height=12,res=500)</span><span class="w">
</span><span class="n">centralityPlot</span><span class="p">(</span><span class="w">
  </span><span class="nf">list</span><span class="p">(</span><span class="n">Complete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">network</span><span class="p">),</span><span class="w">
  </span><span class="n">include</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Strength"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Closeness"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Betweenness"</span><span class="p">),</span><span class="n">orderBy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Strength"</span><span class="p">)</span><span class="w">
</span><span class="c1">#dev.off()</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/network/centrality-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/network/centrality-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/network/centrality-1400.webp"></source> <img src="/assets/img/posts/network/centrality.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="caption"> Centrality measures of the network structure. </div> <h1 id="references">References</h1> <p>Silge, Julia, and David Robinson. 2017. Text Mining with r: A Tidy Approach. “ O’Reilly Media, Inc.” <a href="https://scholar.google.com/scholar?hl=el&amp;as_sdt=0%2C5&amp;q=Silge%2C+Julia%2C+and+David+Robinson.+2017.+Text+Mining+with+r&amp;btnG=" rel="external nofollow noopener" target="_blank">GoogleScholar</a></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/GEE/">Generalized Estimating Equations (GEE)</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/JM/">Joint modeling for longitudinal and time-to-event data</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/survival/">Kaplan-Meier survival estimate</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/longitudinal_plots/">Plotting Longitudinal Data in R</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Iraklis Papadopoulos. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>