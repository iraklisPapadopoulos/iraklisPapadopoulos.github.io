<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Generalized Estimating Equations (GEE) | Iraklis Papadopoulos</title> <meta name="author" content="Iraklis Papadopoulos"> <meta name="description" content="A way of modeling longitudinal data."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/favicon.png?df97677b22c62578555e686f9796e961"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://iraklispapadopoulos.github.io/blog/2024/GEE/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Iraklis </span>Papadopoulos</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/Presentations/">Presentations</a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/projects/">projects</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Generalized Estimating Equations (GEE)</h1> <p class="post-meta">February 20, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/longitudinal"> <i class="fa-solid fa-hashtag fa-sm"></i> longitudinal</a>     ·   <a href="/blog/category/visualization"> <i class="fa-solid fa-tag fa-sm"></i> visualization</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="introduction">Introduction</h2> <p>Generalized Estimating Equations (GEE) are a statistical methodology used for analyzing longitudinal or clustered data. They extend the generalized linear model (GLM) framework to account for dependencies or correlations among observations within clusters, such as repeated measurements on the same individuals over time or multiple measurements from subjects within the same group.</p> <h3 id="key-points">Key Points</h3> <ol> <li> <p><strong>Longitudinal or Clustered Data</strong>: GEE models are particularly useful when dealing with longitudinal data, where multiple observations are made on the same subjects over time, or clustered data, where observations within the same group or cluster are likely to be correlated.</p> </li> <li> <p><strong>Robust to Misspecification of Correlation Structure</strong>: One of the advantages of GEE is its robustness to misspecification of the correlation structure within clusters. Instead of specifying the exact nature of correlations, GEE focuses on estimating the population-average effect, making it less sensitive to the choice of correlation structure.</p> </li> <li> <p><strong>Population-Averaged Model</strong>: GEE models estimate the population-averaged effect of predictors on the outcome variable, rather than focusing on individual-specific effects. This makes them suitable for inference about the average effect across the population.</p> </li> <li> <p><strong>Marginal Models</strong>: GEE models specify the marginal distribution of the outcome variable, meaning they model the average response over all possible values of the covariates, without making distributional assumptions about the predictors.</p> </li> <li> <p><strong>Estimation</strong>: GEE estimation involves iteratively reweighted least squares (IRLS) or quasi-likelihood methods to estimate model parameters. These methods provide consistent estimates of the regression coefficients even when the correlation structure is misspecified.</p> </li> <li> <p><strong>Working Correlation Structure</strong>: While GEE does not require specifying the exact correlation structure, analysts typically specify a working correlation structure, such as exchangeable, independent, or autoregressive, to guide the estimation process.</p> </li> <li> <p><strong>Applications</strong>: GEE models are widely used in various fields such as epidemiology, social sciences, and clinical trials to analyze data with repeated measures, hierarchical structures, or other forms of clustering.</p> </li> </ol> <p>Overall, GEE models offer a flexible and robust approach for analyzing longitudinal or clustered data, allowing researchers to make population-level inferences while accounting for within-cluster correlations.</p> <h2>Model Structure of Generalized Estimating Equations (GEE)</h2> <p>Generalized Estimating Equations (GEE) extend the generalized linear model (GLM) framework to account for dependencies or correlations among observations within clusters, such as repeated measurements on the same individuals over time or multiple measurements from subjects within the same group.</p> <h3>The Model Equation</h3> <p>The general form of the model equation for GEE can be expressed as:</p> <p>\[ g(\mu_{ij}) = \boldsymbol{X}_{ij} \boldsymbol{\beta} + \boldsymbol{Z}_{ij} \boldsymbol{b} \]</p> <p>Where:</p> <ul> <li> <em>g()</em> is the link function.</li> <li>\( \mu_{ij} \) is the expected value of the response variable for the \( i \)-th subject at the \( j \)-th time point.</li> <li>\( \boldsymbol{X}_{ij} \) is a matrix of fixed-effect covariates.</li> <li>\( \boldsymbol{\beta} \) is a vector of fixed-effect coefficients.</li> <li>\( \boldsymbol{Z}_{ij} \) is a matrix of random-effect covariates.</li> <li>\( \boldsymbol{b} \) is a vector of random-effect coefficients.</li> </ul> <h3>Link Function</h3> <p>The link function, denoted as \( g(\cdot) \), relates the expected value of the response variable to the linear predictor. Commonly used link functions include:</p> <ul> <li> <strong>Identity</strong>: \( g(\mu) = \mu \) (for Gaussian family)</li> <li> <strong>Logit</strong>: \( g(\mu) = \log \left( \frac{\mu}{1-\mu} \right) \) (for binomial family)</li> <li> <strong>Log</strong>: \( g(\mu) = \log(\mu) \) (for Poisson family)</li> <li> <strong>Inverse</strong>: \( g(\mu) = \frac{1}{\mu} \) (for Gamma family)</li> </ul> <h3>Working Correlation Structure</h3> <p>In GEE, a working correlation structure is specified to model the within-cluster correlations. Commonly used working correlation structures include:</p> <ul> <li> <strong>Exchangeable</strong>: Assumes constant correlation between all pairs of observations within a cluster.</li> <li> <strong>Independence</strong>: Assumes no correlation between observations within a cluster.</li> <li> <strong>Autoregressive (AR)</strong>: Assumes correlation decreases with increasing time lag between observations within a cluster.</li> </ul> <h3>Estimation Method</h3> <p>GEE estimation involves iteratively reweighted least squares (IRLS) or quasi-likelihood methods to estimate model parameters. These methods provide consistent estimates of the regression coefficients even when the correlation structure is misspecified.</p> <h3>Population-Averaged Model</h3> <p>GEE models estimate the population-averaged effect of predictors on the outcome variable, making them suitable for inference about the average effect across the population.</p> <hr> <p>You can copy and paste this HTML code into an HTML file and view it using any web browser.</p> <h2 id="correlation-structures-in-gee-models">Correlation Structures in GEE Models</h2> <p>In Generalized Estimating Equations (GEE) models, correlation structures (Fig. 1) specify the relationship between observations within clusters, such as repeated measures on the same individuals or measurements from subjects within the same group. Choosing an appropriate correlation structure is essential for accurately modeling the dependencies in the data. Here’s a brief overview of common correlation structures used in GEE models:</p> <ol> <li> <p><strong>Exchangeable</strong>: This is one of the simplest correlation structures, assuming that all pairs of observations within a cluster have the same correlation. It implies that the correlations between any two measurements within a cluster are equal. This structure is often used when there is no prior knowledge about the specific correlation pattern.</p> </li> <li> <p><strong>Independence</strong>: In this structure, it is assumed that all observations within a cluster are uncorrelated. This implies that there is no within-cluster correlation, making it suitable for data where observations within clusters are expected to be independent.</p> </li> <li> <p><strong>Autoregressive (AR)</strong>: In this structure, the correlation between observations decreases as the time lag between them increases. It assumes that observations that are closer in time are more highly correlated than those farther apart. AR structures are commonly used for longitudinal data where observations are collected at equally spaced time intervals.</p> </li> <li> <p><strong>Unstructured</strong>: This structure allows for arbitrary correlations between all pairs of observations within a cluster. It provides the most flexibility but requires estimating a large number of parameters, making it less efficient when the number of clusters is small or the data are sparse.</p> </li> <li> <p><strong>Stationary</strong>: This structure assumes that the correlation between observations depends only on the time lag between them, not on the specific time points. It is a variation of the AR structure and is appropriate when the correlation pattern remains consistent over time.</p> </li> <li> <p><strong>Compound Symmetry (CS)</strong>: Also known as the compound symmetry structure, it assumes constant correlation between all pairs of observations within a cluster, as well as constant variances for each variable. This structure is a combination of the exchangeable and autoregressive structures.</p> </li> </ol> <p>Choosing the appropriate correlation structure depends on the nature of the data and the underlying assumptions about the correlation pattern. Researchers often use model diagnostics, such as residual plots and goodness-of-fit tests, to assess the adequacy of the chosen correlation structure. Additionally, sensitivity analyses may be performed by comparing results across different correlation structures to ensure the robustness of the conclusions drawn from the GEE model.</p> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/gee/cormatrix-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/gee/cormatrix-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/gee/cormatrix-1400.webp"></source> <img src="/assets/img/posts/gee/cormatrix.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="caption"> Fig 1. Most frequent used correlation structures. </div> <h3 id="quasi-likelihood-under-the-independence-model-criterion-qic">Quasi-Likelihood under the Independence Model Criterion (QIC)</h3> <p>The Quasi-Likelihood under the Independence Model Criterion (QIC) is a goodness-of-fit measure used in the context of Generalized Estimating Equations (GEE) models. It serves as a criterion for model selection and comparison in situations where traditional likelihood-based measures may not be appropriate due to the complexity of the correlation structure.</p> <h4 id="purpose">Purpose</h4> <ul> <li> <strong>Model Selection</strong>: QIC helps in selecting the best-fitting model among a set of candidate GEE models with different specifications of fixed effects, covariates, and correlation structures.</li> </ul> <h4 id="calculation">Calculation</h4> <ul> <li> <p><strong>Quasi-Likelihood</strong>: QIC is based on the quasi-likelihood function, which is an approximation to the likelihood function in GEE models. Quasi-likelihood is obtained by replacing the unknown correlation structure with an assumed working correlation structure.</p> </li> <li> <p><strong>Under Independence Model</strong>: QIC is calculated under the assumption of independence, where the working correlation structure is set to independence. This is often denoted as QICu (QIC under the independence model).</p> </li> <li> <p><strong>Penalization for Complexity</strong>: QIC incorporates a penalty term for model complexity, typically based on the number of parameters estimated in the model. This penalty term helps prevent overfitting by favoring simpler models.</p> </li> <li> <p><strong>Lower Values Indicate Better Fit</strong>: Like other information criteria (e.g., AIC, BIC), lower values of QIC indicate better model fit.</p> </li> </ul> <h4 id="interpretation">Interpretation</h4> <ul> <li> <strong>Model Comparison</strong>: Researchers compare the QIC values of different models and select the model with the lowest QIC as the best-fitting model.</li> </ul> <h4 id="limitations">Limitations</h4> <ul> <li> <p><strong>Asymptotic Property</strong>: QIC is based on the quasi-likelihood function, which relies on asymptotic properties. Therefore, it may not perform optimally in small-sample situations.</p> </li> <li> <p><strong>Sensitivity to Model Assumptions</strong>: QIC is sensitive to assumptions about the working correlation structure. Choosing an inappropriate or misspecified working correlation structure can lead to biased QIC values.</p> </li> <li> <p><strong>Comparative Measure</strong>: QIC is most useful when comparing models rather than as an absolute measure of model fit. It should be used in conjunction with other diagnostic tools and criteria.</p> </li> </ul> <h4 id="practical-use">Practical Use</h4> <ul> <li> <p><strong>Software Implementation</strong>: Many statistical software packages that support GEE modeling provide facilities to compute QIC values automatically.</p> </li> <li> <p><strong>Model Refinement</strong>: Researchers often use QIC iteratively to refine models, starting with a simple model and gradually introducing complexity while monitoring changes in QIC.</p> </li> </ul> <h4 id="conclusion">Conclusion</h4> <p>The Quasi-Likelihood under the Independence Model Criterion (QIC) is a valuable tool for model selection and comparison in GEE modeling, providing a balance between goodness of fit and model complexity. However, it is essential to interpret QIC results in conjunction with other diagnostic tools and criteria and to be mindful of its limitations and assumptions.</p> <h2 id="an-example-of-gee-model-in-r">An example of GEE model in R</h2> <pre><code class="language-{R,echo=TRUE,include=TRUE}"># Install and load required package
install.packages("geepack")
library(geepack)

# Set seed for reproducibility
set.seed(123)

# Create simulated data
n &lt;- 100  # Number of subjects
time_points &lt;- 3  # Number of time points
time &lt;- rep(1:time_points, each = n)
id &lt;- rep(1:n, times = time_points)
group &lt;- rep(c("Control", "Treatment"), each = n * time_points / 2)
covariate &lt;- rnorm(n * time_points)
response &lt;- 2 + 0.5 * covariate + rnorm(n * time_points)

# Create data frame
data &lt;- data.frame(id, time, group, covariate, response)

# Perform GEE model with exchangeable correlation matrix
gee_model &lt;- geeglm(response ~ covariate + group, id = id, data = data, family = gaussian, corstr = "exchangeable")

# Summary of the model
summary(gee_model)

</code></pre> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/gee/summary-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/gee/summary-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/gee/summary-1400.webp"></source> <img src="/assets/img/posts/gee/summary.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="caption"> GEE R output. </div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/survival/">Kaplan-Meier survival estimate</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/JM/">Joint modeling for longitudinal and time-to-event data</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/network/">Network Analysis in R</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/longitudinal_plots/">Plotting Longitudinal Data in R</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/pi/">World day of \Pi</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Iraklis Papadopoulos. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>