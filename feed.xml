<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://iraklispapadopoulos.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://iraklispapadopoulos.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2023-12-08T13:33:58+00:00</updated><id>https://iraklispapadopoulos.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Plotting Longitudinal Data in R</title><link href="https://iraklispapadopoulos.github.io/blog/2023/longitudinal_plots/" rel="alternate" type="text/html" title="Plotting Longitudinal Data in R"/><published>2023-12-07T21:01:00+00:00</published><updated>2023-12-07T21:01:00+00:00</updated><id>https://iraklispapadopoulos.github.io/blog/2023/longitudinal_plots</id><content type="html" xml:base="https://iraklispapadopoulos.github.io/blog/2023/longitudinal_plots/"><![CDATA[<p>The following graphs produced upon simulated data of SARSSURV studyâ€™s data and for presentation purposes.</p> <p>In the follo</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">R
</span><span class="n">bxp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggboxplot</span><span class="p">(</span><span class="n">boost</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vax_brand"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"logigg"</span><span class="p">,</span><span class="w">
                 </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vax_brand"</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jco"</span><span class="p">,</span><span class="w">
                 </span><span class="c1">#add = "jitter",</span><span class="w">
                 </span><span class="n">facet.by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"measur"</span><span class="p">,</span><span class="w"> 
                 </span><span class="n">short.panel.labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="w">
</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Vaccines"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log scale Anti-spike IgG (BAU/ml)"</span><span class="p">)</span><span class="o">+</span><span class="w">  </span><span class="n">labs</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Vaccines"</span><span class="p">)</span><span class="w">
 

</span><span class="n">bxp</span><span class="w">


</span><span class="n">library</span><span class="p">(</span><span class="n">rstatix</span><span class="p">)</span><span class="w">

</span><span class="n">stat.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">boost</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">measur</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">t_test</span><span class="p">(</span><span class="n">logigg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">vax_brand</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">adjust_pvalue</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bonferroni"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">add_significance</span><span class="p">(</span><span class="s2">"p.adj"</span><span class="p">)</span><span class="w">
</span><span class="n">stat.test</span><span class="w">

</span><span class="c1"># Additional statistical test</span><span class="w">


</span><span class="c1"># Add p-values of `stat.test` and `stat.test2`</span><span class="w">
</span><span class="c1"># 1. Add stat.test</span><span class="w">
</span><span class="n">stat.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stat.test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">add_xy_position</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vax_brand"</span><span class="p">,</span><span class="w"> </span><span class="n">dodge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">)</span><span class="w">
</span><span class="n">bxp.complex</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bxp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">stat_pvalue_manual</span><span class="p">(</span><span class="w">
  </span><span class="n">stat.test</span><span class="p">,</span><span class="w">  </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"p.adj.signif"</span><span class="p">,</span><span class="w"> </span><span class="n">tip.length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.03</span><span class="p">,</span><span class="n">step.increase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">significant_stat.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stat.test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">p.adj</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0.05</span><span class="p">)</span><span class="w">  </span><span class="c1"># Adjust the significance level if needed</span><span class="w">

</span><span class="c1"># Plot only the significant comparisons</span><span class="w">
</span><span class="n">bxp.complex</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bxp</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">stat_pvalue_manual</span><span class="p">(</span><span class="w">
    </span><span class="n">significant_stat.test</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"p.adj.signif"</span><span class="p">,</span><span class="w"> </span><span class="n">tip.length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.02</span><span class="w">
  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span>
<span class="p">```</span>
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/bxp.complex2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/bxp.complex2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/bxp.complex2-1400.webp"/> <img src="/assets/img/posts/longit_plots/bxp.complex2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> ````markdown ```R ggplot2 ``` ```` <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/bxp.complex.Nab-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/bxp.complex.Nab-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/bxp.complex.Nab-1400.webp"/> <img src="/assets/img/posts/longit_plots/bxp.complex.Nab.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> A simple, elegant caption looks good between image rows, after each row, or doesn't have to be there at all. </div> <p>Images can be made zoomable. Simply add <code class="language-plaintext highlighter-rouge">data-zoomable</code> to <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> tags that you want to make zoomable.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess-1400.webp"/> <img src="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/sdfg-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/sdfg-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/sdfg-1400.webp"/> <img src="/assets/img/posts/longit_plots/sdfg.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div>]]></content><author><name></name></author><category term="visualization"/><category term="longitudinal"/><summary type="html"><![CDATA[Repeated measurements visualization]]></summary></entry></feed>