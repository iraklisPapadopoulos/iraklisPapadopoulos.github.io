<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://iraklispapadopoulos.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://iraklispapadopoulos.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2023-12-09T19:59:30+00:00</updated><id>https://iraklispapadopoulos.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Plotting Longitudinal Data in R</title><link href="https://iraklispapadopoulos.github.io/blog/2023/longitudinal_plots/" rel="alternate" type="text/html" title="Plotting Longitudinal Data in R"/><published>2023-12-07T21:01:00+00:00</published><updated>2023-12-07T21:01:00+00:00</updated><id>https://iraklispapadopoulos.github.io/blog/2023/longitudinal_plots</id><content type="html" xml:base="https://iraklispapadopoulos.github.io/blog/2023/longitudinal_plots/"><![CDATA[<div class="row mt-4"> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/ggplot2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/ggplot2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/ggplot2-1400.webp"/> <img src="/assets/img/posts/longit_plots/ggplot2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/dplyr-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/dplyr-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/dplyr-1400.webp"/> <img src="/assets/img/posts/longit_plots/dplyr.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/tidyr-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/tidyr-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/tidyr-1400.webp"/> <img src="/assets/img/posts/longit_plots/tidyr.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/faux-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/faux-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/faux-1400.webp"/> <img src="/assets/img/posts/longit_plots/faux.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Libraries for this post. </div> <h2 id="introduction">Introduction</h2> <p>For the presentation purposes of this post, simulated data were produced from already existing data of SARSSURV study.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggradar</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggpubr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">faux</span><span class="p">)</span><span class="w">

</span><span class="n">data</span><span class="o">=</span><span class="n">sim_df</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span><span class="w"> </span><span class="m">2000</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h2 id="boxplots">BoxPlots</h2> <p>Boxplots are a valuable tool for presenting longitudinal data, allowing for effective visualization of changes over time and comparisons between groups. The graphical representation makes it easy to highlight trends over different time periods and showcase distinctions between various groups.</p> <p>Bellow there is a sample code to produce such boxplots:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bxp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggboxplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vax_brand"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"logigg"</span><span class="p">,</span><span class="w">
                 </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vax_brand"</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jco"</span><span class="p">,</span><span class="w">
                 </span><span class="c1">#add = "jitter",</span><span class="w">
                 </span><span class="n">facet.by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"measur"</span><span class="p">,</span><span class="w"> 
                 </span><span class="n">short.panel.labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="w">
</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Vaccines"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log scale Anti-spike IgG (BAU/ml)"</span><span class="p">)</span><span class="o">+</span><span class="w">  </span><span class="n">labs</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Vaccines"</span><span class="p">)</span><span class="w">
 

</span><span class="n">bxp</span><span class="w">


</span><span class="n">library</span><span class="p">(</span><span class="n">rstatix</span><span class="p">)</span><span class="w">

</span><span class="n">stat.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">measur</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">t_test</span><span class="p">(</span><span class="n">logigg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">vax_brand</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">adjust_pvalue</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bonferroni"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">add_significance</span><span class="p">(</span><span class="s2">"p.adj"</span><span class="p">)</span><span class="w">
</span><span class="n">stat.test</span><span class="w">

</span><span class="c1"># Additional statistical test</span><span class="w">


</span><span class="c1"># Add p-values of `stat.test` and `stat.test2`</span><span class="w">
</span><span class="c1"># 1. Add stat.test</span><span class="w">
</span><span class="n">stat.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stat.test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">add_xy_position</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vax_brand"</span><span class="p">,</span><span class="w"> </span><span class="n">dodge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">)</span><span class="w">
</span><span class="n">bxp.complex</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bxp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">stat_pvalue_manual</span><span class="p">(</span><span class="w">
  </span><span class="n">stat.test</span><span class="p">,</span><span class="w">  </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"p.adj.signif"</span><span class="p">,</span><span class="w"> </span><span class="n">tip.length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.03</span><span class="p">,</span><span class="n">step.increase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">significant_stat.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stat.test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">p.adj</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0.05</span><span class="p">)</span><span class="w">  </span><span class="c1"># Adjust the significance level if needed</span><span class="w">

</span><span class="c1"># Plot only the significant comparisons</span><span class="w">
</span><span class="n">bxp.complex</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bxp</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">stat_pvalue_manual</span><span class="p">(</span><span class="w">
    </span><span class="n">significant_stat.test</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"p.adj.signif"</span><span class="p">,</span><span class="w"> </span><span class="n">tip.length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.02</span><span class="w">
  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/bxp.complex2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/bxp.complex2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/bxp.complex2-1400.webp"/> <img src="/assets/img/posts/longit_plots/bxp.complex2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/bxp.complex.Nab-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/bxp.complex.Nab-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/bxp.complex.Nab-1400.webp"/> <img src="/assets/img/posts/longit_plots/bxp.complex.Nab.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Visualizing by boxplots the anti-Spike IgG measurements by vaccine type and time period (left) and through time by vaccine type (right). </div> <h2 id="scatter-plot">Scatter plot</h2> <p>One of the initial steps is to visualize the repeated measurements over time and graphically test for linear or non-linear trends. Such graphs play a crucial role in guiding you towards a modeling strategy afterward.</p> <p>Sample code bellow:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="n">p</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">timePoints</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">covidIgG</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">vax_brand</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">vax_brand</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Days since booster Vaccination"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Anti-spike IgG (BAU/ml)"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="n">theme_classic</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">)</span><span class="o">+</span><span class="w">  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"bottom"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"Booster"</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="n">scale_color_lancet</span><span class="p">()</span><span class="w">
</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="o">+</span><span class="w"> </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="o">+</span><span class="w"> </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">))</span><span class="w">
</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="o">+</span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scales</span><span class="o">::</span><span class="n">pretty_breaks</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">))</span><span class="w">
</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme</span><span class="p">(</span><span class="n">plot.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">panel.grid.major</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">panel.grid.minor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">()</span><span class="w"> </span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">())</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.line.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"gray33"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.title.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.text.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">"gray33"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">"gray33"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.line.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"gray33"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">),</span><span class="w">
        </span><span class="n">strip.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">rel</span><span class="p">(</span><span class="m">2.5</span><span class="p">)))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="s2">"Arial"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess-1400.webp"/> <img src="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Anti-Spike IgG through time by booster vaccination vaccine. </div> <h2 id="radar-plot">Radar Plot</h2> <p>A compelling method for visualizing multiple variables concurrently in a plot while minimizing noise is the radar plot. This type of plot effectively communicates both the absolute values and the temporal changes to the reader. It provides a clear representation of the magnitude of true values and their fluctuations over time.</p> <p>Sample code for the radar plot bellow:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggradar</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w">
        </span><span class="n">grid.max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">75</span><span class="p">,</span><span class="w">
        </span><span class="n">base.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w">
        </span><span class="n">font.radar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sans"</span><span class="p">,</span><span class="w">
        </span><span class="n">values.radar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"0%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"35%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"75%"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">result</span><span class="p">)[</span><span class="m">-1</span><span class="p">],</span><span class="w">
        </span><span class="n">grid.min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">
        </span><span class="n">grid.mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w">
        </span><span class="n">grid.line.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">
        </span><span class="n">plot.extent.x.sf</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="w">
        </span><span class="n">plot.extent.y.sf</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="w">
        
        </span><span class="n">gridline.min.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">,</span><span class="w">
        </span><span class="n">gridline.mid.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#007A87"</span><span class="p">,</span><span class="w">
        </span><span class="n">gridline.max.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">,</span><span class="w">
        </span><span class="n">grid.label.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w">
        </span><span class="n">axis.label.offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.15</span><span class="p">,</span><span class="w">
        </span><span class="n">axis.label.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w">
        </span><span class="n">axis.line.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">,</span><span class="w">
        </span><span class="n">group.line.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.7</span><span class="p">,</span><span class="w">
        </span><span class="n">group.point.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
        </span><span class="n">background.circle.transparency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.4</span><span class="p">,</span><span class="w">
        </span><span class="n">background.circle.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#5CB85C"</span><span class="p">,</span><span class="w">
        
        </span><span class="n">group.colours</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lcols</span><span class="p">,</span><span class="w">
        </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Prevalence"</span><span class="p">,</span><span class="w">
        </span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bottom"</span><span class="p">,</span><span class="w">
        </span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="n">legend.text.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w">
        
        </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
        </span><span class="n">fill.alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w">
        </span><span class="n">label.centre.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">
        
        </span><span class="n">gridline.min.linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longdash"</span><span class="p">,</span><span class="w">
        </span><span class="n">gridline.mid.linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longdash"</span><span class="p">,</span><span class="w">
        </span><span class="n">gridline.max.linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longdash"</span><span class="w">
        
        </span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/sdfg-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/sdfg-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/sdfg-1400.webp"/> <img src="/assets/img/posts/longit_plots/sdfg.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Prevalence of symptoms on three time points. </div> <h2 id="spaghetti-plot">Spaghetti Plot</h2> <p>A lot of times, in the process of longitudinal data modeling, linear mixed models (LME) are applied. Linear mixed models make use of random effects. A first visual idea before moving to a modeling technique is to create a spaghetti plot and graphically check the differences in baseline measurements and the individual temporal trends.</p> <p>Sample code for a spaghetti plot bellow:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">xyplot</span><span class="p">(</span><span class="n">IgG</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">boost</span><span class="o">$</span><span class="n">time</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IdParticipant</span><span class="p">,</span><span class="w">
       </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Days after booster vaccination"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Anti-spike IgG (BAU/ml)"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/spagettiPlot-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/spagettiPlot-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/spagettiPlot-1400.webp"/> <img src="/assets/img/posts/longit_plots/spagettiPlot.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Individual anti-Spike IgG changes over time. </div>]]></content><author><name></name></author><category term="visualization"/><category term="longitudinal"/><summary type="html"><![CDATA[Repeated measurements visualization]]></summary></entry><entry><title type="html">Kaplan-Meier survival estimate</title><link href="https://iraklispapadopoulos.github.io/blog/2023/survival/" rel="alternate" type="text/html" title="Kaplan-Meier survival estimate"/><published>2023-12-07T21:01:00+00:00</published><updated>2023-12-07T21:01:00+00:00</updated><id>https://iraklispapadopoulos.github.io/blog/2023/survival</id><content type="html" xml:base="https://iraklispapadopoulos.github.io/blog/2023/survival/"><![CDATA[<h2 id="introduction">Introduction</h2> <p>This post presents the basic theory on Survival Analysis and provide R code to produce Kaplan-Meier plots. In the world of statistics and data science, understanding survival functions and estimating probabilities becomes crucial, especially when dealing with censored data.</p> <p>Survival analysis<d-cite key="aalen2008survival"></d-cite> plays a pivotal role in various fields such as medicine, finance, and sociology, providing valuable insights into the time until an event of interest occurs. At the heart of this analysis is the Kaplan-Meier estimator, a powerful tool for estimating the survival function.</p> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <title>Survival Analysis Basics</title> </head> <body> </body> <body> <h1>Survival Analysis Basics</h1> <ol> <li><strong>Survival Function (S(t)):</strong> The probability that an event has not occurred by time t.</li> <li><strong>Hazard Function (h(t)):</strong> The instantaneous rate of failure at time t.</li> <li><strong>Survival Time (T):</strong> The random variable representing the time until the event.</li> <li><strong>Censoring:</strong> Occurs when event times for some individuals are not observed by the end of the study.</li> <li><strong>Kaplan-Meier Estimator:</strong> Non-parametric estimator for estimating the survival function.</li> <li><strong>Log-Rank Test:</strong> Statistical test to compare survival curves of two or more groups.</li> <li><strong>Cox Proportional-Hazards Model:</strong> Regression model to assess the effect of covariates on the hazard function.</li> <li><strong>Median Survival Time:</strong> The time point at which 50% of subjects have experienced the event.</li> </ol> </body> <p>The Kaplan-Meier estimator is used to estimate the survival function from censored data. The survival function &lt;p&gt;(S(t))&lt;/p&gt; represents the probability that a subject survives beyond time &lt;p&gt;(t) &lt;/p&gt;. The Kaplan-Meier estimator is defined as follows:</p> <p>Identify all unique event times (times at which events occur) and censoring times. Denote them as \(t_1, t_2, \ldots, t_k\).</p> <p>The survival probability at the first event time (\(t_1\)) is calculated as:</p> <p>\[ \hat{S}(t_1) = 1 \]</p> <p>Since there are no events before \(t_1\), the probability of surviving beyond \(t_1\) is 1.</p> <p>For each subsequent event time \(t_i\), where \(i &gt; 1\), the survival probability is calculated using the formula:</p> <p>\[ \hat{S}(t_i) = \hat{S}(t_{i-1}) \times \left(1 - \frac{d_i}{n_i}\right) \]</p> <p>where:</p> <ul> <li>\(d_i\) is the number of events at time \(t_i\).</li> <li>\(n_i\) is the number of subjects at risk just before time \(t_i\).</li> </ul> <p>If there are censored observations at any time point \(t_i\), adjust the probability as follows:</p> <p>\[ \hat{S}(t_i) = \hat{S}(t_{i-1}) \times \left(1 - \frac{d_i}{n_i}\right)^{1 - c_i} \]</p> <p>where \(c_i\) is the number of censored observations at time \(t_i\).</p> <p>The final survival probability at the last event time (\(t_k\)) is the product of all the individual survival probabilities:</p> <p>\[ \hat{S}(t_k) = \hat{S}(t_{k-1}) \times \left(1 - \frac{d_k}{n_k}\right)^{1 - c_k} \]</p> <h3 id="packages">Packages</h3> <div class="row mt-4"> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/survival/ggplot2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/survival/ggplot2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/survival/ggplot2-1400.webp"/> <img src="/assets/img/posts/survival/ggplot2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/survival/tibble.jfif-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/survival/tibble.jfif-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/survival/tibble.jfif-1400.webp"/> <img src="/assets/img/posts/survival/tibble.jfif" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Libraries for this post. </div> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load required libraries</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">survival</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tibble</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">survminer</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h3 id="the-dataset">The dataset</h3> <p>For this post, we’ll generate a dataset with five variables: patient ID, time to event (survival time), event indicator (whether the event occurred or not), and a binary treatment variable (0 or 1) to represent whether each patient received a particular treatment.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Set a seed for reproducibility</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">

</span><span class="c1"># Number of observations</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">

</span><span class="c1"># Generate an imaginary ID</span><span class="w">
</span><span class="n">id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="w">

</span><span class="c1"># Generate a covariate (continuous)</span><span class="w">
</span><span class="n">covariate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w">

</span><span class="c1"># Generate a binary treatment variable (0 or 1)</span><span class="w">
</span><span class="n">treatment</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbinom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">

</span><span class="c1"># Generate survival time (time to event)</span><span class="w">
</span><span class="n">time</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rexp</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">treatment</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.08</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">))</span><span class="w">  </span><span class="c1"># Higher rate for Treatment A</span><span class="w">

</span><span class="c1"># Create event indicator (1=event occurred, 0=censored)</span><span class="w">
</span><span class="n">event</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbinom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pexp</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">))</span><span class="w">

</span><span class="c1"># Map treatment categories to "Treatment A" and "Placebo"</span><span class="w">
</span><span class="n">treatment_category</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">ifelse</span><span class="p">(</span><span class="n">treatment</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"Treatment A"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Placebo"</span><span class="p">),</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Placebo"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Treatment A"</span><span class="p">))</span><span class="w">

</span><span class="c1"># Create a data frame</span><span class="w">
</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tibble</span><span class="p">(</span><span class="w">
  </span><span class="n">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w">
  </span><span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pmin</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w">  </span><span class="c1"># Truncate survival time at 10 units for illustration</span><span class="w">
  </span><span class="n">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w">
  </span><span class="n">Covariate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">covariate</span><span class="p">,</span><span class="w">
  </span><span class="n">Treatment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">treatment_category</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="c1"># Display the first few rows of the dataset</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w">

</span></code></pre></div></div> <h2 id="kaplan-meier-plots">Kaplan-Meier Plots</h2> <html lang="en"> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <title>Survival Analysis Basics and KM Plot Interpretation</title> </head> <body> <h1>Kaplan-Meier Plot Interpretation</h1> <p>A Kaplan-Meier (KM) plot is a graphical representation of the survival function estimated from time-to-event data. It is particularly useful in scenarios where you have censored data and want to visualize the probability of an event (such as death, relapse, or failure) occurring over time.</p> <p><strong>X-Axis (Time):</strong> The horizontal axis represents time, typically in units like days, months, or years, depending on the study design. It shows the duration of the study or observation period.</p> <p><strong>Y-Axis (Survival Probability):</strong> The vertical axis represents the estimated survival probability. At the beginning of the study, the survival probability is 1.0 (100%), indicating that all subjects are alive or have not experienced the event of interest.</p> <p><strong>Steps or Drops:</strong> The plot consists of a series of steps or drops. Each step represents an event (e.g., death) occurring in the study. The height of the step corresponds to the proportion of subjects surviving at that time point.</p> <p><strong>Tick Marks:</strong> Tick marks on the X-axis indicate censored observations, meaning the event did not occur for those subjects during the study period. Censoring is common in survival analysis when subjects are lost to follow-up or the study ends before an event occurs.</p> <p><strong>Curves for Different Groups:</strong> If you're comparing multiple groups, there will be separate curves for each group on the same plot. Differences in the curves can visually indicate whether there are significant disparities in survival times between the groups.</p> <p><strong>Median Survival Time:</strong> The point on the X-axis where the survival curves cross 0.5 (50% survival probability) represents the median survival time. This is the time at which 50% of the subjects have experienced the event of interest.</p> <p><strong>Interpretation:</strong> As you move along the X-axis, the survival probability decreases, reflecting the increasing likelihood of the event occurring. The steeper the drop in the curve, the faster events are happening in that time period. Differences in curves between groups can suggest different survival experiences.</p> </body> </html> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="c1"># Fit Kaplan-Meier survival curve</span><span class="w">
</span><span class="n">fit_km</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">survfit</span><span class="p">(</span><span class="n">Surv</span><span class="p">(</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">Event</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Treatment</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plot Kaplan-Meier curves</span><span class="w">
</span><span class="n">g</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggsurvplot</span><span class="p">(</span><span class="w">
  </span><span class="n">fit_km</span><span class="p">,</span><span class="w">
  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w">
  </span><span class="n">risk.table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
  </span><span class="n">pval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
  </span><span class="n">conf.int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
  </span><span class="n">ggtheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">(),</span><span class="w">
  </span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"#0073C2FF"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#EFC000FF"</span><span class="p">),</span><span class="w">  </span><span class="c1"># Blue for Treatment A, Yellow for Placebo</span><span class="w">
  </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Treatment"</span><span class="p">,</span><span class="w">
  </span><span class="n">legend.labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Treatment A"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Placebo"</span><span class="p">),</span><span class="w">
  </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Time"</span><span class="p">,</span><span class="w">
  </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Survival Probability"</span><span class="p">,</span><span class="w">
  </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Kaplan-Meier Survival Curves by Treatment"</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="w">

</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/survival/km-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/survival/km-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/survival/km-1400.webp"/> <img src="/assets/img/posts/survival/km.jpeg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Anti-Spike IgG through time by booster vaccination vaccine. </div> <h2 id="comparing-survival-curves-between-groups">Comparing Survival Curves between Groups</h2> <p>The log-rank test is a statistical method used to compare the survival distributions of two or more groups in a study. It is commonly employed in survival analysis, where the primary outcome is time until a particular event of interest occurs (e.g., death, relapse, failure).</p> <p>The log-rank test assesses whether there are any significant differences in the survival experiences of different groups over time. It does so by comparing the observed number of events (e.g., deaths) in each group with the number of events that would be expected if the null hypothesis were true, assuming no difference between the groups.</p> <p>The null hypothesis for the log-rank test is that there is no difference in the survival distributions of the compared groups. If the test yields a p-value below a predetermined significance level (commonly 0.05), it indicates that there is evidence to reject the null hypothesis, suggesting that there are significant differences in survival experiences between the groups.</p> <p>The log-rank test is a non-parametric test, meaning that it makes no assumptions about the shape of the survival distributions. It is widely used in clinical trials, epidemiology, and other fields where researchers are interested in comparing the time-to-event outcomes between different groups.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Perform log-rank test</span><span class="w">
</span><span class="n">logrank_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">survdiff</span><span class="p">(</span><span class="n">Surv</span><span class="p">(</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">Event</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Treatment</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">

</span><span class="c1"># Display the log-rank test results</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">logrank_test</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>Inline-style: <img src="https://github.com/adam-p/markdown-here/raw/master/src/common/images/icon48.png" alt="alt text" title="Logo Title Text 1"/></p> <p>Reference-style: ![alt text][logo]</p>]]></content><author><name></name></author><category term="visualization"/><category term="survival"/><summary type="html"><![CDATA[Principal theory and R code for KM survival estimate and comparissons between survival curves]]></summary></entry></feed>