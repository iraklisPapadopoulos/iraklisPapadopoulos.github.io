<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://iraklispapadopoulos.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://iraklispapadopoulos.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-06-11T10:30:13+00:00</updated><id>https://iraklispapadopoulos.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">World day of π</title><link href="https://iraklispapadopoulos.github.io/blog/2024/pi/" rel="alternate" type="text/html" title="World day of π"/><published>2024-03-14T21:01:00+00:00</published><updated>2024-03-14T21:01:00+00:00</updated><id>https://iraklispapadopoulos.github.io/blog/2024/pi</id><content type="html" xml:base="https://iraklispapadopoulos.github.io/blog/2024/pi/"><![CDATA[<h1 id="the-number-π">The Number π</h1> <p>The number π (symbolized internationally by the Greek letter π) is a mathematical constant defined as the ratio of the circumference to the diameter of a circle, and is equal to 3.14159265 to eight decimal places. It has been expressed with the Greek letter π since the middle of the 18th century. π is an irrational number, meaning that it cannot be expressed exactly as a ratio of two integers (such as 22/7 or other fractions commonly used to approximate π). Therefore, the decimal representation never ends and never settles in a permanent and recurring pattern. π is a transcendental number – that is, it is not a root of a non-zero polynomial with exponential coefficients.</p> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/pi/pi2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/pi/pi2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/pi/pi2-1400.webp"/> <img src="/assets/img/posts/pi/pi2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <h1 id="world-π-day-celebration">World π Day Celebration</h1> <p>World π Day is not exclusively for mathematicians and is celebrated every year on March 14th because of some numerical coincidences that occur on that day. In America, for example, 14/3 is written as 3-14, which is the value of the constant (π = 3.14).</p> <p>The celebration of “p” day was established in 1988 by Larry Shaw in San Francisco. It is celebrated with the consumption of round pies because in English, the Greek letter π resembles the English word “pie” which is pronounced as “pie”.</p> <h1 id="the-story-of-π">The Story of π</h1> <p>When the ancient Babylonians began to build the city - says the legend - they were particularly concerned with geometry. Already from the 20th century BCE, they found that when the circumference of any circle is divided by its diameter, the result is always about three. They even calculated the value of this ratio at 25/8, which is only 0.5% of its true value. Much less accurate is the other of the most ancient values of π, which we find in the Bible (1 Kings, 7, 23), according to which the circular lake of Solomon’s house had a diameter of ten cubits and a circumference of thirty cubits, placing the value exactly at three.</p> <p>One of the oldest and most accurate values is that of the Egyptian scribe Ahmes. He recorded it in a papyrus of the Middle Kingdom, around 1650 BCE, essentially copying an even more ancient papyrus. Ahmes described π as the result of dividing 256 by 81, i.e., 3.160.</p> <p>But the one who is considered to have been the first to approach the calculation of π on a more theoretical basis was Archimedes, which is why π is also known as Archimedes’ constant. Chinese, Indian, and Persian sages all tried to calculate this constant. However, the name we know it by today was given to it in 1706, when the Welsh mathematician William Jones proposed that Archimedes’ constant be named after the Greek letter π, from the word “perimeter”.</p> <p>However, the great difficulties with π had not yet begun. In 1761, Johann Lambert proved that π is an irrational number. In simple terms, this means that it cannot be expressed as a fraction of two whole numbers. In school, children learn that π is approximately 22/7, but this value is again approximate because π is beyond mathematical logic.</p> <p>The second major breakthrough came in 1882, when Ferdinand von Lindemann proved that π had another unusual property: it was a transcendental number. In mathematical terms, this means that it is not the root of any algebraic equation with exponential coefficients.</p> <p>In non-mathematical terms, this means that π is the proof of the old adage that one cannot square the circle. That is, one cannot, using only a ruler and a compass, make a square that has exactly the same area as a given circle.</p> <p>But the elegance of the nature of π is summed up in the many efforts that have been and continue to be made to complete its numbers. The persistent search may have begun with the German mathematician Ludolph van Ceulen, who around 1600 calculated the first 35 decimal places of π. He was so proud of this work, to which he devoted much of his life, that he requested that the 35 digits be inscribed on his tombstone. Equally persistent, William Shanks, for his part, spent 20 years calculating, advancing π to 707 decimal places. Unfortunately, his achievement suffered a huge blow when the first digital computers discovered that he had made a mistake in the 528th decimal place, rendering all subsequent ones useless.</p> <p>The expansion of π to infinity has also repeatedly attracted the interest of science fiction writers. The great American astronomer Carl Sagan, in his book “Contact,” hid the signature of the aliens in the supposedly random digits of π, which in fact do not follow any particular order.</p>]]></content><author><name></name></author><category term="facts"/><category term="stories"/><summary type="html"><![CDATA[Historical facts about π]]></summary></entry><entry><title type="html">Joint modeling for longitudinal and time-to-event data</title><link href="https://iraklispapadopoulos.github.io/blog/2024/JM/" rel="alternate" type="text/html" title="Joint modeling for longitudinal and time-to-event data"/><published>2024-02-29T21:01:00+00:00</published><updated>2024-02-29T21:01:00+00:00</updated><id>https://iraklispapadopoulos.github.io/blog/2024/JM</id><content type="html" xml:base="https://iraklispapadopoulos.github.io/blog/2024/JM/"><![CDATA[<h2 id="introduction">Introduction</h2> <p>Joint modeling for longitudinal data and time-to-event data is a statistical approach used to simultaneously analyze repeated measurements from longitudinal studies and time-to-event outcomes such as survival or failure times. Here are a few key points about joint modeling:</p> <h3 id="key-points">Key Points</h3> <ol> <li> <p><strong>Integration of Longitudinal and Time-to-Event Data</strong>: In many longitudinal studies, individuals are followed over time, and repeated measurements are collected on them. In addition to these longitudinal measurements, researchers are often interested in understanding the time until a specific event occurs, such as death, relapse, or disease progression. Joint modeling integrates these two types of data to provide a comprehensive analysis of the relationship between the longitudinal measurements and the time-to-event outcome.</p> </li> <li> <p><strong>Addressing Dependency</strong>: Longitudinal data often exhibit dependency, as measurements taken over time on the same individual are likely to be correlated. Ignoring this dependency can lead to biased parameter estimates and incorrect conclusions. Joint modeling properly accounts for this dependency by modeling both the longitudinal and time-to-event processes simultaneously.</p> </li> <li> <p><strong>Shared Parameter Models</strong>: Joint modeling typically involves the specification of two sub-models: a longitudinal sub-model and a survival sub-model. The longitudinal sub-model describes the trajectory of the longitudinal measurements over time, while the survival sub-model describes the hazard or survival function. These sub-models are connected through shared parameters, such as random effects or latent variables, which capture the association between the longitudinal and time-to-event processes.</p> </li> <li> <p><strong>Benefits</strong>: Joint modeling offers several advantages over separate analyses of longitudinal and time-to-event data. By jointly modeling these data types, it enables more efficient estimation of parameters and provides more precise inference on the association between the longitudinal measurements and the time-to-event outcome. Additionally, joint modeling can handle missing data more flexibly than separate analyses, as it can accommodate intermittent missingness in the longitudinal measurements.</p> </li> <li> <p><strong>Applications</strong>: Joint modeling has been widely used in various fields, including medical research, epidemiology, and social sciences. It has applications in longitudinal clinical trials, where researchers want to assess the impact of a treatment on both longitudinal outcomes (e.g., biomarker levels) and survival outcomes (e.g., time to disease progression or death). Joint modeling is also used in studies of disease progression, where researchers aim to understand how longitudinal biomarker measurements predict the risk of disease onset or progression.</p> </li> </ol> <p>Overall, joint modeling provides a powerful framework for analyzing longitudinal and time-to-event data simultaneously, allowing researchers to gain deeper insights into the underlying processes and associations within their data.</p> <h1 id="references">References</h1> <p>Rizopoulos, Dimitris. Joint models for longitudinal and time-to-event data: With applications in R. CRC press, 2012. <a href="https://scholar.google.com/scholar?hl=el&amp;as_sdt=0%2C5&amp;q=Rizopoulos%2C+Dimitris.+Joint+models+for+longitudinal+and+time-to-event+data%3A+With+applications+in+R.+CRC+press%2C+2012.&amp;btnG=">GoogleScholar</a></p>]]></content><author><name></name></author><category term="visualization"/><category term="longitudinal"/><summary type="html"><![CDATA[A statistical approach used to simultaneously analyze repeated measurements from longitudinal studies and time-to-event outcomes such as survival or failure times]]></summary></entry><entry><title type="html">Generalized Estimating Equations (GEE)</title><link href="https://iraklispapadopoulos.github.io/blog/2024/GEE/" rel="alternate" type="text/html" title="Generalized Estimating Equations (GEE)"/><published>2024-02-20T21:01:00+00:00</published><updated>2024-02-20T21:01:00+00:00</updated><id>https://iraklispapadopoulos.github.io/blog/2024/GEE</id><content type="html" xml:base="https://iraklispapadopoulos.github.io/blog/2024/GEE/"><![CDATA[<h2 id="introduction">Introduction</h2> <p>Generalized Estimating Equations (GEE) are a statistical methodology used for analyzing longitudinal or clustered data. They extend the generalized linear model (GLM) framework to account for dependencies or correlations among observations within clusters, such as repeated measurements on the same individuals over time or multiple measurements from subjects within the same group.</p> <h3 id="key-points">Key Points</h3> <ol> <li> <p><strong>Longitudinal or Clustered Data</strong>: GEE models are particularly useful when dealing with longitudinal data, where multiple observations are made on the same subjects over time, or clustered data, where observations within the same group or cluster are likely to be correlated.</p> </li> <li> <p><strong>Robust to Misspecification of Correlation Structure</strong>: One of the advantages of GEE is its robustness to misspecification of the correlation structure within clusters. Instead of specifying the exact nature of correlations, GEE focuses on estimating the population-average effect, making it less sensitive to the choice of correlation structure.</p> </li> <li> <p><strong>Population-Averaged Model</strong>: GEE models estimate the population-averaged effect of predictors on the outcome variable, rather than focusing on individual-specific effects. This makes them suitable for inference about the average effect across the population.</p> </li> <li> <p><strong>Marginal Models</strong>: GEE models specify the marginal distribution of the outcome variable, meaning they model the average response over all possible values of the covariates, without making distributional assumptions about the predictors.</p> </li> <li> <p><strong>Estimation</strong>: GEE estimation involves iteratively reweighted least squares (IRLS) or quasi-likelihood methods to estimate model parameters. These methods provide consistent estimates of the regression coefficients even when the correlation structure is misspecified.</p> </li> <li> <p><strong>Working Correlation Structure</strong>: While GEE does not require specifying the exact correlation structure, analysts typically specify a working correlation structure, such as exchangeable, independent, or autoregressive, to guide the estimation process.</p> </li> <li> <p><strong>Applications</strong>: GEE models are widely used in various fields such as epidemiology, social sciences, and clinical trials to analyze data with repeated measures, hierarchical structures, or other forms of clustering.</p> </li> </ol> <p>Overall, GEE models offer a flexible and robust approach for analyzing longitudinal or clustered data, allowing researchers to make population-level inferences while accounting for within-cluster correlations.</p> <h2>Model Structure of Generalized Estimating Equations (GEE)</h2> <p>Generalized Estimating Equations (GEE) extend the generalized linear model (GLM) framework to account for dependencies or correlations among observations within clusters, such as repeated measurements on the same individuals over time or multiple measurements from subjects within the same group.</p> <h3>The Model Equation</h3> <p>The general form of the model equation for GEE can be expressed as:</p> <p>\[ g(\mu_{ij}) = \boldsymbol{X}_{ij} \boldsymbol{\beta} + \boldsymbol{Z}_{ij} \boldsymbol{b} \]</p> <p>Where:</p> <ul> <li><em>g()</em> is the link function.</li> <li>\( \mu_{ij} \) is the expected value of the response variable for the \( i \)-th subject at the \( j \)-th time point.</li> <li>\( \boldsymbol{X}_{ij} \) is a matrix of fixed-effect covariates.</li> <li>\( \boldsymbol{\beta} \) is a vector of fixed-effect coefficients.</li> <li>\( \boldsymbol{Z}_{ij} \) is a matrix of random-effect covariates.</li> <li>\( \boldsymbol{b} \) is a vector of random-effect coefficients.</li> </ul> <h3>Link Function</h3> <p>The link function, denoted as \( g(\cdot) \), relates the expected value of the response variable to the linear predictor. Commonly used link functions include:</p> <ul> <li><strong>Identity</strong>: \( g(\mu) = \mu \) (for Gaussian family)</li> <li><strong>Logit</strong>: \( g(\mu) = \log \left( \frac{\mu}{1-\mu} \right) \) (for binomial family)</li> <li><strong>Log</strong>: \( g(\mu) = \log(\mu) \) (for Poisson family)</li> <li><strong>Inverse</strong>: \( g(\mu) = \frac{1}{\mu} \) (for Gamma family)</li> </ul> <h3>Working Correlation Structure</h3> <p>In GEE, a working correlation structure is specified to model the within-cluster correlations. Commonly used working correlation structures include:</p> <ul> <li><strong>Exchangeable</strong>: Assumes constant correlation between all pairs of observations within a cluster.</li> <li><strong>Independence</strong>: Assumes no correlation between observations within a cluster.</li> <li><strong>Autoregressive (AR)</strong>: Assumes correlation decreases with increasing time lag between observations within a cluster.</li> </ul> <h3>Estimation Method</h3> <p>GEE estimation involves iteratively reweighted least squares (IRLS) or quasi-likelihood methods to estimate model parameters. These methods provide consistent estimates of the regression coefficients even when the correlation structure is misspecified.</p> <h3>Population-Averaged Model</h3> <p>GEE models estimate the population-averaged effect of predictors on the outcome variable, making them suitable for inference about the average effect across the population.</p> <hr/> <p>You can copy and paste this HTML code into an HTML file and view it using any web browser.</p> <h2 id="correlation-structures-in-gee-models">Correlation Structures in GEE Models</h2> <p>In Generalized Estimating Equations (GEE) models, correlation structures (Fig. 1) specify the relationship between observations within clusters, such as repeated measures on the same individuals or measurements from subjects within the same group. Choosing an appropriate correlation structure is essential for accurately modeling the dependencies in the data. Here’s a brief overview of common correlation structures used in GEE models:</p> <ol> <li> <p><strong>Exchangeable</strong>: This is one of the simplest correlation structures, assuming that all pairs of observations within a cluster have the same correlation. It implies that the correlations between any two measurements within a cluster are equal. This structure is often used when there is no prior knowledge about the specific correlation pattern.</p> </li> <li> <p><strong>Independence</strong>: In this structure, it is assumed that all observations within a cluster are uncorrelated. This implies that there is no within-cluster correlation, making it suitable for data where observations within clusters are expected to be independent.</p> </li> <li> <p><strong>Autoregressive (AR)</strong>: In this structure, the correlation between observations decreases as the time lag between them increases. It assumes that observations that are closer in time are more highly correlated than those farther apart. AR structures are commonly used for longitudinal data where observations are collected at equally spaced time intervals.</p> </li> <li> <p><strong>Unstructured</strong>: This structure allows for arbitrary correlations between all pairs of observations within a cluster. It provides the most flexibility but requires estimating a large number of parameters, making it less efficient when the number of clusters is small or the data are sparse.</p> </li> <li> <p><strong>Stationary</strong>: This structure assumes that the correlation between observations depends only on the time lag between them, not on the specific time points. It is a variation of the AR structure and is appropriate when the correlation pattern remains consistent over time.</p> </li> <li> <p><strong>Compound Symmetry (CS)</strong>: Also known as the compound symmetry structure, it assumes constant correlation between all pairs of observations within a cluster, as well as constant variances for each variable. This structure is a combination of the exchangeable and autoregressive structures.</p> </li> </ol> <p>Choosing the appropriate correlation structure depends on the nature of the data and the underlying assumptions about the correlation pattern. Researchers often use model diagnostics, such as residual plots and goodness-of-fit tests, to assess the adequacy of the chosen correlation structure. Additionally, sensitivity analyses may be performed by comparing results across different correlation structures to ensure the robustness of the conclusions drawn from the GEE model.</p> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/gee/cormatrix-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/gee/cormatrix-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/gee/cormatrix-1400.webp"/> <img src="/assets/img/posts/gee/cormatrix.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Fig 1. Most frequent used correlation structures. </div> <h3 id="quasi-likelihood-under-the-independence-model-criterion-qic">Quasi-Likelihood under the Independence Model Criterion (QIC)</h3> <p>The Quasi-Likelihood under the Independence Model Criterion (QIC) is a goodness-of-fit measure used in the context of Generalized Estimating Equations (GEE) models. It serves as a criterion for model selection and comparison in situations where traditional likelihood-based measures may not be appropriate due to the complexity of the correlation structure.</p> <h4 id="purpose">Purpose</h4> <ul> <li><strong>Model Selection</strong>: QIC helps in selecting the best-fitting model among a set of candidate GEE models with different specifications of fixed effects, covariates, and correlation structures.</li> </ul> <h4 id="calculation">Calculation</h4> <ul> <li> <p><strong>Quasi-Likelihood</strong>: QIC is based on the quasi-likelihood function, which is an approximation to the likelihood function in GEE models. Quasi-likelihood is obtained by replacing the unknown correlation structure with an assumed working correlation structure.</p> </li> <li> <p><strong>Under Independence Model</strong>: QIC is calculated under the assumption of independence, where the working correlation structure is set to independence. This is often denoted as QICu (QIC under the independence model).</p> </li> <li> <p><strong>Penalization for Complexity</strong>: QIC incorporates a penalty term for model complexity, typically based on the number of parameters estimated in the model. This penalty term helps prevent overfitting by favoring simpler models.</p> </li> <li> <p><strong>Lower Values Indicate Better Fit</strong>: Like other information criteria (e.g., AIC, BIC), lower values of QIC indicate better model fit.</p> </li> </ul> <h4 id="interpretation">Interpretation</h4> <ul> <li><strong>Model Comparison</strong>: Researchers compare the QIC values of different models and select the model with the lowest QIC as the best-fitting model.</li> </ul> <h4 id="limitations">Limitations</h4> <ul> <li> <p><strong>Asymptotic Property</strong>: QIC is based on the quasi-likelihood function, which relies on asymptotic properties. Therefore, it may not perform optimally in small-sample situations.</p> </li> <li> <p><strong>Sensitivity to Model Assumptions</strong>: QIC is sensitive to assumptions about the working correlation structure. Choosing an inappropriate or misspecified working correlation structure can lead to biased QIC values.</p> </li> <li> <p><strong>Comparative Measure</strong>: QIC is most useful when comparing models rather than as an absolute measure of model fit. It should be used in conjunction with other diagnostic tools and criteria.</p> </li> </ul> <h4 id="practical-use">Practical Use</h4> <ul> <li> <p><strong>Software Implementation</strong>: Many statistical software packages that support GEE modeling provide facilities to compute QIC values automatically.</p> </li> <li> <p><strong>Model Refinement</strong>: Researchers often use QIC iteratively to refine models, starting with a simple model and gradually introducing complexity while monitoring changes in QIC.</p> </li> </ul> <h4 id="conclusion">Conclusion</h4> <p>The Quasi-Likelihood under the Independence Model Criterion (QIC) is a valuable tool for model selection and comparison in GEE modeling, providing a balance between goodness of fit and model complexity. However, it is essential to interpret QIC results in conjunction with other diagnostic tools and criteria and to be mindful of its limitations and assumptions.</p> <h2 id="an-example-of-gee-model-in-r">An example of GEE model in R</h2> <pre><code class="language-{R,echo=TRUE,include=TRUE}"># Install and load required package
install.packages("geepack")
library(geepack)

# Set seed for reproducibility
set.seed(123)

# Create simulated data
n &lt;- 100  # Number of subjects
time_points &lt;- 3  # Number of time points
time &lt;- rep(1:time_points, each = n)
id &lt;- rep(1:n, times = time_points)
group &lt;- rep(c("Control", "Treatment"), each = n * time_points / 2)
covariate &lt;- rnorm(n * time_points)
response &lt;- 2 + 0.5 * covariate + rnorm(n * time_points)

# Create data frame
data &lt;- data.frame(id, time, group, covariate, response)

# Perform GEE model with exchangeable correlation matrix
gee_model &lt;- geeglm(response ~ covariate + group, id = id, data = data, family = gaussian, corstr = "exchangeable")

# Summary of the model
summary(gee_model)

</code></pre> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/gee/summary-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/gee/summary-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/gee/summary-1400.webp"/> <img src="/assets/img/posts/gee/summary.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> GEE R output. </div>]]></content><author><name></name></author><category term="visualization"/><category term="longitudinal"/><summary type="html"><![CDATA[A way of modeling longitudinal data.]]></summary></entry><entry><title type="html">Network Analysis in R</title><link href="https://iraklispapadopoulos.github.io/blog/2024/network/" rel="alternate" type="text/html" title="Network Analysis in R"/><published>2024-01-25T21:01:00+00:00</published><updated>2024-01-25T21:01:00+00:00</updated><id>https://iraklispapadopoulos.github.io/blog/2024/network</id><content type="html" xml:base="https://iraklispapadopoulos.github.io/blog/2024/network/"><![CDATA[<h1 id="introduction-to-network-analysis">Introduction to Network Analysis</h1> <p>Network analysis is a powerful tool used to study complex systems composed of interconnected elements, such as social networks, biological systems, or infrastructure networks. It allows researchers to understand the structure and dynamics of relationships between individual components within a system.</p> <h2 id="what-is-network-analysis">What is Network Analysis?</h2> <p>Network analysis involves representing a system as a network, which consists of nodes (representing entities) and edges (representing relationships or interactions between entities). By studying the patterns of connections and interactions within the network, researchers can gain insights into the underlying structure and behavior of the system.</p> <h2 id="visualization">Visualization</h2> <p>Visualization is crucial for understanding and interpreting network data. Network analysis often involves creating visual representations of the network using graphical techniques. These visualizations can range from simple node-and-edge diagrams to more complex layouts that highlight various properties of the network, such as node centrality or community structure.</p> <h2 id="testing-accuracy">Testing Accuracy</h2> <p>Assessing the accuracy of a network model involves comparing it to empirical data or evaluating its predictive performance. This can be done using statistical techniques such as goodness-of-fit tests, cross-validation, or comparing model predictions to observed outcomes.</p> <h2 id="centrality">Centrality</h2> <p>Centrality measures quantify the importance or influence of nodes within a network. Nodes with high centrality are often considered to be more central or influential within the network. Common centrality measures include degree centrality (number of connections), betweenness centrality (importance of a node in connecting other nodes), and closeness centrality (average distance to all other nodes).</p> <h2 id="comparing-networks">Comparing Networks</h2> <p>Comparing networks involves assessing similarities or differences between two or more networks. This can be done by comparing their topological properties, such as degree distributions, average path lengths, or clustering coefficients. Additionally, specialized techniques exist for comparing networks with different node sets or edge weights.</p> <h1 id="r-packages-for-network-analysis">R Packages for Network Analysis</h1> <p>The <code class="language-plaintext highlighter-rouge">qgraph</code> and <code class="language-plaintext highlighter-rouge">netboot</code> packages in R provide tools for visualizing and analyzing networks.</p> <ul> <li><code class="language-plaintext highlighter-rouge">qgraph</code>: Particularly useful for creating high-quality network visualizations.</li> <li><code class="language-plaintext highlighter-rouge">netboot</code>: Offers methods for bootstrapping network models to test their stability and accuracy.</li> </ul> <p>By leveraging these packages, researchers can gain valuable insights into the structure and dynamics of complex systems through network analysis in R.</p> <h1 id="an-example">An Example</h1> <p>In this example, we’ll perform network analysis on a dataset of Covid-19 infection symptoms using R. We’ll visualize the correlation network, test the significance of correlations, and estimate the network structure.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load required libraries</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">corrplot</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">corpcor</span><span class="p">)</span><span class="w">  </span><span class="c1"># for partial correlation</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">qgraph</span><span class="p">)</span><span class="w"> </span><span class="c1"># for visualization</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">bootnet</span><span class="p">)</span><span class="w"> </span><span class="c1"># to estimate stability</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span><span class="w">  </span><span class="c1">#to use grid.arrange</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">QuantPsyc</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h2 id="the-data-preparation">The data preparation</h2> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Define COVID-19 symptoms</span><span class="w">
</span><span class="n">symptoms</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Fever"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Cough"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Shortness of breath"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Fatigue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Muscle or body aches"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"Headache"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Sore throat"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Loss of taste or smell"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Congestion or runny nose"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"Nausea or vomiting"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Generate random data for correlation between symptoms</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">num_symptoms</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">symptoms</span><span class="p">)</span><span class="w">

</span></code></pre></div></div> <h2 id="estimating-and-visualizing-network-structure">Estimating and Visualizing Network Structure</h2> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">correlation_matrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">num_symptoms</span><span class="o">^</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.5</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_symptoms</span><span class="p">)</span><span class="w">

</span><span class="c1"># Set diagonal to 1</span><span class="w">
</span><span class="n">diag</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="c1"># Estimate the network structure</span><span class="w">
</span><span class="n">network</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">estimateNetwork</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"pcor"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plot the estimated network</span><span class="w">
</span><span class="c1">#png("network.png",units="cm", width=12, height=12,res=500)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">network</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">symptoms</span><span class="p">)</span><span class="w">
</span><span class="c1">#dev.off()</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/network/network-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/network/network-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/network/network-1400.webp"/> <img src="/assets/img/posts/network/network.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Network structure between Covid-19 symptoms. </div> <h2 id="centrality-and-accuracy">Centrality and Accuracy</h2> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#png("centrality.png",units="cm", width=12, height=12,res=500)</span><span class="w">
</span><span class="n">centralityPlot</span><span class="p">(</span><span class="w">
  </span><span class="nf">list</span><span class="p">(</span><span class="n">Complete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">network</span><span class="p">),</span><span class="w">
  </span><span class="n">include</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Strength"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Closeness"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Betweenness"</span><span class="p">),</span><span class="n">orderBy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Strength"</span><span class="p">)</span><span class="w">
</span><span class="c1">#dev.off()</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/network/centrality-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/network/centrality-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/network/centrality-1400.webp"/> <img src="/assets/img/posts/network/centrality.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Centrality measures of the network structure. </div> <h1 id="references">References</h1> <p>Silge, Julia, and David Robinson. 2017. Text Mining with r: A Tidy Approach. “ O’Reilly Media, Inc.” <a href="https://scholar.google.com/scholar?hl=el&amp;as_sdt=0%2C5&amp;q=Silge%2C+Julia%2C+and+David+Robinson.+2017.+Text+Mining+with+r&amp;btnG=">GoogleScholar</a></p>]]></content><author><name></name></author><category term="visualization"/><category term="network"/><summary type="html"><![CDATA[Main principles and R code to perform network analysis in R.]]></summary></entry><entry><title type="html">Plotting Longitudinal Data in R</title><link href="https://iraklispapadopoulos.github.io/blog/2023/longitudinal_plots/" rel="alternate" type="text/html" title="Plotting Longitudinal Data in R"/><published>2023-12-07T21:01:00+00:00</published><updated>2023-12-07T21:01:00+00:00</updated><id>https://iraklispapadopoulos.github.io/blog/2023/longitudinal_plots</id><content type="html" xml:base="https://iraklispapadopoulos.github.io/blog/2023/longitudinal_plots/"><![CDATA[<div class="row mt-4"> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/ggplot2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/ggplot2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/ggplot2-1400.webp"/> <img src="/assets/img/posts/longit_plots/ggplot2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/dplyr-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/dplyr-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/dplyr-1400.webp"/> <img src="/assets/img/posts/longit_plots/dplyr.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/tidyr-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/tidyr-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/tidyr-1400.webp"/> <img src="/assets/img/posts/longit_plots/tidyr.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/faux-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/faux-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/faux-1400.webp"/> <img src="/assets/img/posts/longit_plots/faux.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Libraries for this post. </div> <h2 id="introduction">Introduction</h2> <p>For the presentation purposes of this post, simulated data were produced from already existing data of SARSSURV study.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggradar</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggpubr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">faux</span><span class="p">)</span><span class="w">

</span><span class="n">data</span><span class="o">=</span><span class="n">sim_df</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span><span class="w"> </span><span class="m">2000</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h2 id="boxplots">BoxPlots</h2> <p>Boxplots are a valuable tool for presenting longitudinal data, allowing for effective visualization of changes over time and comparisons between groups. The graphical representation makes it easy to highlight trends over different time periods and showcase distinctions between various groups.</p> <p>Bellow there is a sample code to produce such boxplots:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bxp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggboxplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vax_brand"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"logigg"</span><span class="p">,</span><span class="w">
                 </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vax_brand"</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"jco"</span><span class="p">,</span><span class="w">
                 </span><span class="c1">#add = "jitter",</span><span class="w">
                 </span><span class="n">facet.by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"measur"</span><span class="p">,</span><span class="w"> 
                 </span><span class="n">short.panel.labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="w">
</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Vaccines"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log scale Anti-spike IgG (BAU/ml)"</span><span class="p">)</span><span class="o">+</span><span class="w">  </span><span class="n">labs</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Vaccines"</span><span class="p">)</span><span class="w">
 

</span><span class="n">bxp</span><span class="w">


</span><span class="n">library</span><span class="p">(</span><span class="n">rstatix</span><span class="p">)</span><span class="w">

</span><span class="n">stat.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">measur</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">t_test</span><span class="p">(</span><span class="n">logigg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">vax_brand</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">adjust_pvalue</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bonferroni"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">add_significance</span><span class="p">(</span><span class="s2">"p.adj"</span><span class="p">)</span><span class="w">
</span><span class="n">stat.test</span><span class="w">

</span><span class="c1"># Additional statistical test</span><span class="w">


</span><span class="c1"># Add p-values of `stat.test` and `stat.test2`</span><span class="w">
</span><span class="c1"># 1. Add stat.test</span><span class="w">
</span><span class="n">stat.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stat.test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">add_xy_position</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vax_brand"</span><span class="p">,</span><span class="w"> </span><span class="n">dodge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">)</span><span class="w">
</span><span class="n">bxp.complex</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bxp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">stat_pvalue_manual</span><span class="p">(</span><span class="w">
  </span><span class="n">stat.test</span><span class="p">,</span><span class="w">  </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"p.adj.signif"</span><span class="p">,</span><span class="w"> </span><span class="n">tip.length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.03</span><span class="p">,</span><span class="n">step.increase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">significant_stat.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stat.test</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">p.adj</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0.05</span><span class="p">)</span><span class="w">  </span><span class="c1"># Adjust the significance level if needed</span><span class="w">

</span><span class="c1"># Plot only the significant comparisons</span><span class="w">
</span><span class="n">bxp.complex</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bxp</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">stat_pvalue_manual</span><span class="p">(</span><span class="w">
    </span><span class="n">significant_stat.test</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"p.adj.signif"</span><span class="p">,</span><span class="w"> </span><span class="n">tip.length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.02</span><span class="w">
  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/bxp.complex2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/bxp.complex2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/bxp.complex2-1400.webp"/> <img src="/assets/img/posts/longit_plots/bxp.complex2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/bxp.complex.Nab-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/bxp.complex.Nab-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/bxp.complex.Nab-1400.webp"/> <img src="/assets/img/posts/longit_plots/bxp.complex.Nab.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Visualizing by boxplots the anti-Spike IgG measurements by vaccine type and time period (left) and through time by vaccine type (right). </div> <h2 id="scatter-plot">Scatter plot</h2> <p>One of the initial steps is to visualize the repeated measurements over time and graphically test for linear or non-linear trends. Such graphs play a crucial role in guiding you towards a modeling strategy afterward.</p> <p>Sample code bellow:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="n">p</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">timePoints</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">covidIgG</span><span class="p">,</span><span class="n">group</span><span class="o">=</span><span class="n">vax_brand</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">vax_brand</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Days since booster Vaccination"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Anti-spike IgG (BAU/ml)"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="n">theme_classic</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">)</span><span class="o">+</span><span class="w">  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"bottom"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"Booster"</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="n">scale_color_lancet</span><span class="p">()</span><span class="w">
</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="o">+</span><span class="w"> </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="o">+</span><span class="w"> </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">))</span><span class="w">
</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="o">+</span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scales</span><span class="o">::</span><span class="n">pretty_breaks</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">))</span><span class="w">
</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme</span><span class="p">(</span><span class="n">plot.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">panel.grid.major</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">panel.grid.minor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">()</span><span class="w"> </span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">())</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.line.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"gray33"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.title.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.text.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">"gray33"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">"gray33"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.line.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"gray33"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">),</span><span class="w">
        </span><span class="n">strip.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">rel</span><span class="p">(</span><span class="m">2.5</span><span class="p">)))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="s2">"Arial"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess-1400.webp"/> <img src="/assets/img/posts/longit_plots/IgG_boost_vaccine_loess.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Anti-Spike IgG through time by booster vaccination vaccine. </div> <h2 id="radar-plot">Radar Plot</h2> <p>A compelling method for visualizing multiple variables concurrently in a plot while minimizing noise is the radar plot. This type of plot effectively communicates both the absolute values and the temporal changes to the reader. It provides a clear representation of the magnitude of true values and their fluctuations over time.</p> <p>Sample code for the radar plot bellow:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggradar</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w">
        </span><span class="n">grid.max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">75</span><span class="p">,</span><span class="w">
        </span><span class="n">base.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w">
        </span><span class="n">font.radar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sans"</span><span class="p">,</span><span class="w">
        </span><span class="n">values.radar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"0%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"35%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"75%"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">result</span><span class="p">)[</span><span class="m">-1</span><span class="p">],</span><span class="w">
        </span><span class="n">grid.min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">
        </span><span class="n">grid.mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w">
        </span><span class="n">grid.line.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">
        </span><span class="n">plot.extent.x.sf</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="w">
        </span><span class="n">plot.extent.y.sf</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="w">
        
        </span><span class="n">gridline.min.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">,</span><span class="w">
        </span><span class="n">gridline.mid.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#007A87"</span><span class="p">,</span><span class="w">
        </span><span class="n">gridline.max.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">,</span><span class="w">
        </span><span class="n">grid.label.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w">
        </span><span class="n">axis.label.offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.15</span><span class="p">,</span><span class="w">
        </span><span class="n">axis.label.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w">
        </span><span class="n">axis.line.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">,</span><span class="w">
        </span><span class="n">group.line.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.7</span><span class="p">,</span><span class="w">
        </span><span class="n">group.point.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
        </span><span class="n">background.circle.transparency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.4</span><span class="p">,</span><span class="w">
        </span><span class="n">background.circle.colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#5CB85C"</span><span class="p">,</span><span class="w">
        
        </span><span class="n">group.colours</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lcols</span><span class="p">,</span><span class="w">
        </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Prevalence"</span><span class="p">,</span><span class="w">
        </span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bottom"</span><span class="p">,</span><span class="w">
        </span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="n">legend.text.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w">
        
        </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
        </span><span class="n">fill.alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w">
        </span><span class="n">label.centre.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">
        
        </span><span class="n">gridline.min.linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longdash"</span><span class="p">,</span><span class="w">
        </span><span class="n">gridline.mid.linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longdash"</span><span class="p">,</span><span class="w">
        </span><span class="n">gridline.max.linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"longdash"</span><span class="w">
        
        </span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/sdfg-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/sdfg-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/sdfg-1400.webp"/> <img src="/assets/img/posts/longit_plots/sdfg.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Prevalence of symptoms on three time points. </div> <h2 id="spaghetti-plot">Spaghetti Plot</h2> <p>A lot of times, in the process of longitudinal data modeling, linear mixed models (LME) are applied. Linear mixed models make use of random effects. A first visual idea before moving to a modeling technique is to create a spaghetti plot and graphically check the differences in baseline measurements and the individual temporal trends.</p> <p>Sample code for a spaghetti plot bellow:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">xyplot</span><span class="p">(</span><span class="n">IgG</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">boost</span><span class="o">$</span><span class="n">time</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IdParticipant</span><span class="p">,</span><span class="w">
       </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Days after booster vaccination"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Anti-spike IgG (BAU/ml)"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/longit_plots/spagettiPlot-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/longit_plots/spagettiPlot-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/longit_plots/spagettiPlot-1400.webp"/> <img src="/assets/img/posts/longit_plots/spagettiPlot.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Individual anti-Spike IgG changes over time. </div>]]></content><author><name></name></author><category term="visualization"/><category term="longitudinal"/><summary type="html"><![CDATA[Repeated measurements visualization]]></summary></entry><entry><title type="html">Kaplan-Meier survival estimate</title><link href="https://iraklispapadopoulos.github.io/blog/2023/survival/" rel="alternate" type="text/html" title="Kaplan-Meier survival estimate"/><published>2023-12-07T21:01:00+00:00</published><updated>2023-12-07T21:01:00+00:00</updated><id>https://iraklispapadopoulos.github.io/blog/2023/survival</id><content type="html" xml:base="https://iraklispapadopoulos.github.io/blog/2023/survival/"><![CDATA[<h2 id="introduction">Introduction</h2> <p>This post presents the basic theory of Survival Analysis and provides R code to generate Kaplan-Meier plots. In the world of statistics and data science, understanding survival functions and estimating probabilities becomes crucial, especially when dealing with censored data.</p> <p>Survival analysis<d-cite key="aalen2008survival"></d-cite> plays a pivotal role in various fields such as medicine, finance, and sociology, providing valuable insights into the time until an event of interest occurs. At the heart of this analysis is the Kaplan-Meier estimator, a powerful tool for estimating the survival function.</p> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <title>Survival Analysis Basics</title> </head> <body> </body> <body> <h1>Survival Analysis Basics</h1> <ol> <li><strong>Survival Function (S(t)):</strong> The probability that an event has not occurred by time t.</li> <li><strong>Hazard Function (h(t)):</strong> The instantaneous rate of failure at time t.</li> <li><strong>Survival Time (T):</strong> The random variable representing the time until the event.</li> <li><strong>Censoring:</strong> Occurs when event times for some individuals are not observed by the end of the study.</li> <li><strong>Kaplan-Meier Estimator:</strong> Non-parametric estimator for estimating the survival function.</li> <li><strong>Log-Rank Test:</strong> Statistical test to compare survival curves of two or more groups.</li> <li><strong>Cox Proportional-Hazards Model:</strong> Regression model to assess the effect of covariates on the hazard function.</li> <li><strong>Median Survival Time:</strong> The time point at which 50% of subjects have experienced the event.</li> </ol> </body> <p>The Kaplan-Meier estimator is used to estimate the survival function from censored data. The survival function S(t) represents the probability that a subject survives beyond time t. The Kaplan-Meier estimator is defined as follows:</p> <p>Identify all unique event times (times at which events occur) and censoring times. Denote them as \(t_1, t_2, \ldots, t_k\).</p> <p>The survival probability at the first event time (\(t_1\)) is calculated as:</p> <p>\[ \hat{S}(t_1) = 1 \]</p> <p>Since there are no events before \(t_1\), the probability of surviving beyond \(t_1\) is 1.</p> <p>For each subsequent event time \(t_i\), where \(i &gt; 1\), the survival probability is calculated using the formula:</p> <p>\[ \hat{S}(t_i) = \hat{S}(t_{i-1}) \times \left(1 - \frac{d_i}{n_i}\right) \]</p> <p>where:</p> <ul> <li>\(d_i\) is the number of events at time \(t_i\).</li> <li>\(n_i\) is the number of subjects at risk just before time \(t_i\).</li> </ul> <p>If there are censored observations at any time point \(t_i\), adjust the probability as follows:</p> <p>\[ \hat{S}(t_i) = \hat{S}(t_{i-1}) \times \left(1 - \frac{d_i}{n_i}\right)^{1 - c_i} \]</p> <p>where \(c_i\) is the number of censored observations at time \(t_i\).</p> <p>The final survival probability at the last event time (\(t_k\)) is the product of all the individual survival probabilities:</p> <p>\[ \hat{S}(t_k) = \hat{S}(t_{k-1}) \times \left(1 - \frac{d_k}{n_k}\right)^{1 - c_k} \]</p> <h3 id="packages">Packages</h3> <div class="row mt-4"> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/survival/ggplot2-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/survival/ggplot2-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/survival/ggplot2-1400.webp"/> <img src="/assets/img/posts/survival/ggplot2.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-6 col-sm-3 mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/survival/tibble.jfif-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/survival/tibble.jfif-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/survival/tibble.jfif-1400.webp"/> <img src="/assets/img/posts/survival/tibble.jfif" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Libraries for this post. </div> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load required libraries</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">survival</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tibble</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">survminer</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h3 id="the-dataset">The dataset</h3> <p>For this post, we’ll generate a dataset with five variables: patient ID, time to event (survival time), event indicator (whether the event occurred or not), and a binary treatment variable (0 or 1) to represent whether each patient received a particular treatment.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Set a seed for reproducibility</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">

</span><span class="c1"># Number of observations</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">

</span><span class="c1"># Generate an imaginary ID</span><span class="w">
</span><span class="n">id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="w">

</span><span class="c1"># Generate a covariate (continuous)</span><span class="w">
</span><span class="n">covariate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w">

</span><span class="c1"># Generate a binary treatment variable (0 or 1)</span><span class="w">
</span><span class="n">treatment</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbinom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">

</span><span class="c1"># Generate survival time (time to event)</span><span class="w">
</span><span class="n">time</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rexp</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">treatment</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.08</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">))</span><span class="w">  </span><span class="c1"># Higher rate for Treatment A</span><span class="w">

</span><span class="c1"># Create event indicator (1=event occurred, 0=censored)</span><span class="w">
</span><span class="n">event</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbinom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pexp</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">))</span><span class="w">

</span><span class="c1"># Map treatment categories to "Treatment A" and "Placebo"</span><span class="w">
</span><span class="n">treatment_category</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">ifelse</span><span class="p">(</span><span class="n">treatment</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"Treatment A"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Placebo"</span><span class="p">),</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Placebo"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Treatment A"</span><span class="p">))</span><span class="w">

</span><span class="c1"># Create a data frame</span><span class="w">
</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tibble</span><span class="p">(</span><span class="w">
  </span><span class="n">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w">
  </span><span class="n">Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pmin</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w">  </span><span class="c1"># Truncate survival time at 10 units for illustration</span><span class="w">
  </span><span class="n">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w">
  </span><span class="n">Covariate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">covariate</span><span class="p">,</span><span class="w">
  </span><span class="n">Treatment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">treatment_category</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="c1"># Display the first few rows of the dataset</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w">

</span></code></pre></div></div> <h2 id="kaplan-meier-plots">Kaplan-Meier Plots</h2> <html lang="en"> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <title>Survival Analysis Basics and KM Plot Interpretation</title> </head> <body> <h1>Kaplan-Meier Plot Interpretation</h1> <p>A Kaplan-Meier (KM) plot is a graphical representation of the survival function estimated from time-to-event data. It is particularly useful in scenarios where you have censored data and want to visualize the probability of an event (such as death, relapse, or failure) occurring over time.</p> <p><strong>X-Axis (Time):</strong> The horizontal axis represents time, typically in units like days, months, or years, depending on the study design. It shows the duration of the study or observation period.</p> <p><strong>Y-Axis (Survival Probability):</strong> The vertical axis represents the estimated survival probability. At the beginning of the study, the survival probability is 1.0 (100%), indicating that all subjects are alive or have not experienced the event of interest.</p> <p><strong>Steps or Drops:</strong> The plot consists of a series of steps or drops. Each step represents an event (e.g., death) occurring in the study. The height of the step corresponds to the proportion of subjects surviving at that time point.</p> <p><strong>Tick Marks:</strong> Tick marks on the X-axis indicate censored observations, meaning the event did not occur for those subjects during the study period. Censoring is common in survival analysis when subjects are lost to follow-up or the study ends before an event occurs.</p> <p><strong>Curves for Different Groups:</strong> If you're comparing multiple groups, there will be separate curves for each group on the same plot. Differences in the curves can visually indicate whether there are significant disparities in survival times between the groups.</p> <p><strong>Median Survival Time:</strong> The point on the X-axis where the survival curves cross 0.5 (50% survival probability) represents the median survival time. This is the time at which 50% of the subjects have experienced the event of interest.</p> <p><strong>Interpretation:</strong> As you move along the X-axis, the survival probability decreases, reflecting the increasing likelihood of the event occurring. The steeper the drop in the curve, the faster events are happening in that time period. Differences in curves between groups can suggest different survival experiences.</p> </body> </html> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="c1"># Fit Kaplan-Meier survival curve</span><span class="w">
</span><span class="n">fit_km</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">survfit</span><span class="p">(</span><span class="n">Surv</span><span class="p">(</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">Event</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Treatment</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plot Kaplan-Meier curves</span><span class="w">
</span><span class="n">g</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggsurvplot</span><span class="p">(</span><span class="w">
  </span><span class="n">fit_km</span><span class="p">,</span><span class="w">
  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w">
  </span><span class="n">risk.table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
  </span><span class="n">pval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
  </span><span class="n">conf.int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
  </span><span class="n">ggtheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">(),</span><span class="w">
  </span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"#0073C2FF"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#EFC000FF"</span><span class="p">),</span><span class="w">  </span><span class="c1"># Blue for Treatment A, Yellow for Placebo</span><span class="w">
  </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Treatment"</span><span class="p">,</span><span class="w">
  </span><span class="n">legend.labs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Treatment A"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Placebo"</span><span class="p">),</span><span class="w">
  </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Time"</span><span class="p">,</span><span class="w">
  </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Survival Probability"</span><span class="p">,</span><span class="w">
  </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Kaplan-Meier Survival Curves by Treatment"</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="w">

</span></code></pre></div></div> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/posts/survival/km-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/posts/survival/km-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/posts/survival/km-1400.webp"/> <img src="/assets/img/posts/survival/km.jpeg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="caption"> Anti-Spike IgG through time by booster vaccination vaccine. </div> <h2 id="comparing-survival-curves-between-groups">Comparing Survival Curves between Groups</h2> <p>The log-rank test is a statistical method used to compare the survival distributions of two or more groups in a study. It is commonly employed in survival analysis, where the primary outcome is time until a particular event of interest occurs (e.g., death, relapse, failure).</p> <p>The log-rank test assesses whether there are any significant differences in the survival experiences of different groups over time. It does so by comparing the observed number of events (e.g., deaths) in each group with the number of events that would be expected if the null hypothesis were true, assuming no difference between the groups.</p> <p>The null hypothesis for the log-rank test is that there is no difference in the survival distributions of the compared groups. If the test yields a p-value below a predetermined significance level (commonly 0.05), it indicates that there is evidence to reject the null hypothesis, suggesting that there are significant differences in survival experiences between the groups.</p> <p>The log-rank test is a non-parametric test, meaning that it makes no assumptions about the shape of the survival distributions. It is widely used in clinical trials, epidemiology, and other fields where researchers are interested in comparing the time-to-event outcomes between different groups.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Perform log-rank test</span><span class="w">
</span><span class="n">logrank_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">survdiff</span><span class="p">(</span><span class="n">Surv</span><span class="p">(</span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">Event</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Treatment</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">

</span><span class="c1"># Display the log-rank test results</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">logrank_test</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Call:
survdiff(formula = Surv(Time, Event) ~ Treatment, data = data)<span class="sb">

                       N Observed Expected (O-E)^2/E (O-E)^2/V
</span>Treatment=Placebo     52       24     24.1  0.000667   0.00253
Treatment=Treatment A 48       28     27.9  0.000578   0.00253

 Chisq= 0  on 1 degrees of freedom, p= 1 
</code></pre></div></div>]]></content><author><name></name></author><category term="visualization"/><category term="survival"/><summary type="html"><![CDATA[Main principles and R code for Kaplan-Meier survival estimation and comparisons of survival curves.]]></summary></entry></feed>